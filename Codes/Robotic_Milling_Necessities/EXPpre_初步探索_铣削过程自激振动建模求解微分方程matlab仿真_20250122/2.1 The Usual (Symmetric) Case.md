* * *

1. Overview of the Main Steps
-----------------------------

1. **Collect/Fit Modal Parameters**
   
    * For _each_ vibration mode $k$, you need:
        * Natural frequency $\omega_{\mathrm{n},k}$ (in rad/s, or you can store in Hz and convert),
        * Damping ratio $\zeta_k$,
        * Complex right-eigenvector components $\psi^R_{ik}$ (which describe the mode shape for direction $i$),
        * Complex left-eigenvector components $\psi^L_{ik}$.
    * If the FRF is non-symmetric, you _cannot_ assume $\psi^R = \psi^L$.
    * You have shown data for two modes (14 & 15). We’ll incorporate them into a combined 2-DOF system (since each mode shapes the tool’s tip in x and y directions).
2. **Define Cutting Parameters**
   
    * Tangential cutting force coefficient $K_t$ and radial cutting force coefficient $K_r$,
    * Helix angle $\beta$ (if relevant to your computation of time delays across the axial depth),
    * Number of teeth $N$,
    * Feed per tooth $f_z$,
    * Cutter diameter $D$,
    * Radial immersion ratio $\frac{a_e}{D}$ (where $a_e$ is the radial depth of cut),
    * Axial depth of cut $a_p$ (the variable in your stability-lobe diagram),
    * Milling type ($+1$ for up-milling or $-1$ for down-milling) – you already denoted `up_or_down = -1`.
3. **Build the Time-Periodic Linearized Model**
   
    * After linearization (per the paper’s Eq. (31)–(39)), you get a time-periodic Delay-Differential Equation (DDE).
    * In state-space form (as in Eq. (40)–(41)): $$ \dot{\mathbf{q}}_{\mathbf{v}}(t) = \mathbf{A}(t) \,\mathbf{q}_{\mathbf{v}}(t)\;+\;\mathbf{B}(t)\,\mathbf{u}(t-\tau),  
        \quad  
        \mathbf{u}(t) = \mathbf{D}\,\mathbf{q}_{\mathbf{v}}(t),$$ where $\tau$ is the time delay between tooth passes $\bigl(\tau = 60/(N\,\Omega)\bigr)$.
4. **Semi-Discretization Method (SDM)**
   
    * Discretize one tooth period (of length $\tau$) into small steps of size $h$. Let $p = \tau / h$.
    * Approximate $\mathbf{A}(t)$ and $\mathbf{B}(t)$ as piecewise constant on each sub-interval.
    * Solve each small step analytically to get transition matrices $\mathbf{G}_k$.
    * Multiply them over one full tooth period to get $\mathbf{\Pi}\approx \mathbf{G}_{p-1}\cdots \mathbf{G}_{1}$.
    * The system is stable if $\max |\mu_i| < 1$, where $\mu_i$ are eigenvalues of $\mathbf{\Pi}$.
5. **Loop Over Spindle Speed $$\Omega$$ and Depth of Cut $$a_p$$**
   
    * For each $(\Omega, a_p)$ in your sweep, build $\mathbf{A}(t)$, $\mathbf{B}(t)$, do the SDM, and see if $\max |\mu_i|$ is $< 1$.
    * Record whether that point is stable or not.
    * Contour or color-map the $(\Omega, a_p)$-plane to get the stability lobe diagram.

* * *



**You:**

How to Collect/Fit Modal Parameters

For each vibration mode **k**, you need:

* Natural frequency **𝜔ₙ,ₖ** (in rad/s, or stored in Hz and converted).
* Damping ratio **𝜁ₖ**.
* Complex right-eigenvector components **𝜓ᵢₖᴿ** (describing the mode shape for direction **i**).
* Complex left-eigenvector components **𝜓ᵢₖᴸ**.

Explain especially what **Complex right-eigenvector components** and **Complex left-eigenvector components** are, with illustration and analogy.



**ChatGPT:**

Let’s start with a **real-world analogy**. Imagine two giant springs (representing different modes of vibration in your machine structure). Each spring can bounce in a certain direction with a certain frequency and damping. Now suppose there are also fans blowing sideways or a rotating gyroscope attached—effects that _twist_ and _tilt_ these modes so that the vibrations “slant” from one direction into another. Because of that twist, the way the structure responds (right-eigenvector) might be different from the way you have to push on it to excite that same mode (left-eigenvector).

In more technical terms:

* * *

1. What Are “Modal Parameters” and Why Are They Needed?
-------------------------------------------------------

When you measure a machine’s vibrations (frequency response functions, or FRFs) around a certain spindle speed, you identify **vibration modes**. Each mode $k$ roughly corresponds to “how” the structure likes to vibrate at a certain **natural frequency** $\omega_{\mathrm{n},k}$ (with some damping $\zeta_k$). But you also need the **mode shape**—i.e., which directions in space the structure moves when it vibrates in that mode.

If the machine’s mathematical model is **non-symmetric** (due to gyroscopic effects, fluid forces, magnetic fields, etc.), then each mode has a **right-eigenvector** (the response shape) and a **left-eigenvector** (the excitation shape). They are _not_ simply the same vector.

* * *

2. Complex Right- and Left-Eigenvectors in a Nutshell
-----------------------------------------------------

### 2.1 The Usual (Symmetric) Case

* If the system is symmetric (like a normal mass-spring with no rotation), the eigenvectors are just real-valued “mode shapes.” Every mode is basically “This is how the structure wiggles in that mode.”
  
* Mathematically, you often see a matrix equation like:
  
    $$ \mathbf{A}\,\mathbf{x} \;=\;\lambda\,\mathbf{x},$$
    
    where $\mathbf{A}$ might be the system’s dynamic matrix, $\mathbf{x}$ is the _right_-eigenvector, and $\lambda$ is the eigenvalue.
    
* For a symmetric system, the left-eigenvector (which satisfies $\mathbf{y}^T \mathbf{A} = \lambda\, \mathbf{y}^T$) is simply the same as the right-eigenvector ($\mathbf{x}$).
  

### 2.2 The Non-Symmetric Case

* Now add in something that _breaks_ symmetry (like a rotating spindle with gyroscopic effects). The dynamic matrix $\mathbf{A}$ becomes **non-symmetric**, so the standard eigenvalue problem splits into two:
  
    $$ \mathbf{A} \,\mathbf{x}_k \;=\;\lambda_k \,\mathbf{x}_k  
    \quad\quad\Longrightarrow\quad\text{(right-eigenvector)}$$ $$ \mathbf{y}_k^{T} \,\mathbf{A} \;=\;\lambda_k \,\mathbf{y}_k^{T}  
    \quad\quad\Longrightarrow\quad\text{(left-eigenvector)},$$
    
    where $\mathbf{x}_k$ is generally _not_ equal to $\mathbf{y}_k$.
    
* Physically:
  
    * **$\mathbf{x}_k$ (Right-Eigenvector)**: describes _how_ the system _responds_ when it vibrates in mode $k$. It’s the shape of the vibration, telling you which directions and phases of motion are involved.
    * **$\mathbf{y}_k$ (Left-Eigenvector)**: describes which pattern of forcing or excitation actually _excites_ that particular mode. In other words, if you push the structure in exactly the pattern given by $\mathbf{y}_k$, it will purely excite mode $k$.

Because the system is non-symmetric, the shape for “response” ($\mathbf{x}_k$) is no longer the same as the shape for “excitation” ($\mathbf{y}_k$).

### 2.3 Why They’re “Complex”

Even if your system is physically real (displacements in meters, forces in newtons), the mode shapes for damped or gyroscopic systems can come out as **complex-valued**. That usually means the mode shape involves a certain phase shift (the system’s $x$ and $y$ directions might not be perfectly in-phase as it oscillates).

When you measure the FRFs and do **curve fitting**, you might see each mode requires complex parameters to match the amplitude and phase in both directions $x$ and $y$.

* * *

3. Collecting or Fitting These Parameters From FRFs
---------------------------------------------------

1. **Perform an Experimental FRF Measurement**
   
    * Typically, you do “tap tests” or “shaker tests” on the tool tip in two perpendicular directions, measuring the system’s vibrations. That gives you a frequency response matrix $\mathbf{H}(\omega)$.
2. **Identify Each Mode**
   
    * You look for the resonance peaks in $\mathbf{H}(\omega)$.
    * For each mode $k$, note the peak frequency (in Hz). Convert to $\omega_{\mathrm{n},k} = 2\pi\,f_k$.
3. **Estimate the Damping Ratio**
   
    * From the half-power bandwidth or curve-fitting approach, you get the damping ratio $\zeta_k$ (the fraction of critical damping).
4. **Extract the Mode Shapes**
   
    * Because the system is non-symmetric, you must do a more general fit that yields $\mathbf{x}_k = \psi^R_k$ (right-eigenvector) and $\mathbf{y}_k = \psi^L_k$ (left-eigenvector).
    * In practical software (e.g., “Modal Analysis” modules), you often see columns of complex mode shapes. These come from the singular value decomposition or polyreference methods, but conceptually they’re giving you $\psi^R_{x}, \psi^R_{y}$ and $\psi^L_{x}, \psi^L_{y}$.
5. **Normalize If Needed**
   
    * In the paper’s equations, you often scale the eigenvectors so that $\mathbf{y}_k^{T} \mathbf{A} \mathbf{x}_k = 1$. This ensures consistent usage in the linearized equations of motion.

* * *

4. Putting It All Together
--------------------------

* Each mode $k$ has:
  
    1. **$\omega_{\mathrm{n},k}$**: Natural frequency (rad/s),
    2. **$\zeta_k$**: Damping ratio,
    3. **$\psi_{xk}^R,\;\psi_{yk}^R$**: Right-eigenvector components in $x,y$,
    4. **$\psi_{xk}^L,\;\psi_{yk}^L$**: Left-eigenvector components in $x,y$.
* If the machine’s FRF matrix is _only slightly_ non-symmetric, $\psi^R$ and $\psi^L$ might _almost_ match, but typically you’ll see noticeable differences.
  
* For chatter and stability-lobe analysis, **both** the right- and left-eigenvectors matter because you must transform your coordinate system from physical space (where cutting forces act) into modal space (where each mode vibrates).
  

* * *

### Short Analogy Recap

* **Right-eigenvector**: _“If you let the structure _ring_ freely, here’s the shape it actually vibrates in.”_
* **Left-eigenvector**: _“If you want to _excite that same shape_ purely, here’s how you must push on the structure.”_

When the system is symmetrical (like two identical seesaws side by side with no weird couplings), these shapes coincide. But if there’s a swirling fan or rotating mass that “pushes” the seesaws differently in different directions, the shape you have to push in is no longer the same shape the seesaws produce when they bounce freely.

* * *

5. Final Takeaway
-----------------

To **collect/fit** these parameters, you typically:

1. **Measure** the tool-tip FRF in two (or more) directions.
2. **Identify** each resonance peak to get frequency, damping, amplitude, and phase relationships.
3. **Perform** a **curve-fitting** or **modal parameter estimation** method that accounts for non-symmetric coupling (thus you get complex left- and right-eigenvectors).
4. **Store** them in your model as $\omega_{\mathrm{n},k}$, $\zeta_k$, $\psi_{ik}^R$, and $\psi_{ik}^L$.

You then plug these parameters into your **chatter stability** equations (semi-discretization or multi-frequency method) to get the accurate stability lobe diagrams.

That’s all there is: you measure, you fit, you get these special _complex left- and right-eigenvectors_, and you use them to accurately predict chatter and stability in milling.



**You:**

After obtaining modal params, how can I Build the Time-Periodic Linearized Model? It is where the non-proportional, non-symmetric model implemented and the state-space method employed?
 \dot{\mathbf{q}}_{\mathbf{v}}(t) = \mathbf{A}(t) \,\mathbf{q}_{\mathbf{v}}(t)\;+\;\mathbf{B}(t)\,\mathbf{u}(t-\tau),
\quad
\mathbf{u}(t) = \mathbf{D}\,\mathbf{q}_{\mathbf{v}}(t),



**ChatGPT:**

**Analogy (First, a Simple Picture):**

Think of a **carousel** with several **dancing puppets** attached to it. Each puppet can move in its own style (the “mode shape”), and the carousel spins around. Because of the rotation and how each puppet is attached, forces on these puppets change **periodically** in time—once each rotation.

* If the carousel were perfectly symmetrical, pushing puppet A forward would only move puppet A.
* But if there’s a **twisting linkage** (non-symmetry), pushing puppet A might also wiggle puppet B.

In this analogy, each puppet’s “dance” is a vibration **mode**, and each puppet’s actual motion is described in the “modal coordinates.” Meanwhile, the spinning carousel changes how the puppets get forced over time—this results in a **time-periodic** system matrix $\mathbf{A}(t)$. If you also have **delayed feedback** (like each puppet sees what the other puppet did one rotation earlier), that adds the $\mathbf{u}(t-\tau)$ term with $\tau$ = one rotation period.

* * *

Building the Time-Periodic Linearized Model
-------------------------------------------

Now for the **detailed, step-by-step** explanation of how to go from your _modal parameters_ to the _non-symmetric, time-periodic state-space system_:

* * *

### 1. Start with the Physical Equations (Delay-Differential Form)

From typical cutting-force analysis (like in the paper’s Equation (31) or (37)), you have something like:

$$\mathbf{M}\,\ddot{\boldsymbol{\varepsilon}}(t)  
\;+\;  
\mathbf{C}\,\dot{\boldsymbol{\varepsilon}}(t)  
\;+\;  
\mathbf{K}\,\boldsymbol{\varepsilon}(t)  
\;=\;  
\widetilde{\mathbf{\kappa}}(t)\,\bigl[\boldsymbol{\varepsilon}(t-\tau)-\boldsymbol{\varepsilon}(t)\bigr],$$

where:

* $\boldsymbol{\varepsilon}(t)$ is the small vibration displacement near the tool tip (in physical $x,y$ directions, possibly plus other directions).
* $\widetilde{\mathbf{\kappa}}(t)$ is the **time-periodic “directional factor matrix”** that depends on tool rotation angle $\varphi(t)$. It basically captures the geometry (entry/exit angles, radial immersion, helix angle, etc.).
* $\tau$ is the **tooth-passing delay**, i.e. the time between successive cuts by the same flute.

Because your machine may have **non-proportional damping** (matrices $\mathbf{C}, \mathbf{K}, \mathbf{M}$ are not simultaneously diagonalizable) **and** because rotation or fluid interactions can make the system **non-symmetric**, you can’t assume simpler real-valued mode shapes or symmetrical dynamic matrices.

* * *

### 2. Convert to First-Order State-Space

Rewrite the above second-order equation as a **first-order** system of dimension $2n$. One common way (the paper does a similar approach) is:

1. Let $\mathbf{z}(t) \;=\; \begin{bmatrix} \boldsymbol{\varepsilon}(t) \\[5pt] \dot{\boldsymbol{\varepsilon}}(t) \end{bmatrix}$.
   
2. Then your equation becomes
   
    $$\underbrace{\begin{pmatrix}  
    \mathbf{C} & \mathbf{M} \\  
    \mathbf{M} & \mathbf{0}  
    \end{pmatrix}}_{\widehat{\mathbf{A}}}  
    \;\dot{\mathbf{z}}(t)  
    \;+\;  
    \underbrace{\begin{pmatrix}  
    \mathbf{K} & \mathbf{0} \\  
    \mathbf{0} & -\mathbf{M}  
    \end{pmatrix}}_{\widehat{\mathbf{B}}}  
    \;\mathbf{z}(t)  
    \;=\;  
    \widetilde{\mathbf{\kappa}}(t)\,\bigl[\mathbf{z}(t-\tau)-\mathbf{z}(t)\bigr].$$
    
    That is a **delay-differential equation (DDE)** in first-order form, with **time-periodic** forcing matrix $\widetilde{\mathbf{\kappa}}(t)$.
    

* * *

### 3. Transform to **Modal Coordinates** Using Left/Right Eigenvectors

Your measured or fitted **modal parameters** supply:

* **Natural frequencies** $\omega_{\mathrm{n},k}$ and **damping** $\zeta_k$ for each mode $k$.
* **Right-eigenvector** $\psi^R_k$ (which is how the structure responds in mode $k$).
* **Left-eigenvector** $\psi^L_k$ (which shows how best to excite that same mode).

For **non-symmetric** $\widehat{\mathbf{A}}, \widehat{\mathbf{B}}$, you solve:

$$(\widehat{\mathbf{A}} \,\lambda + \widehat{\mathbf{B}})\,\mathbf{U}_R = \mathbf{0}  
\quad\quad\text{and}\quad\quad  
(\widehat{\mathbf{A}}^T \,\lambda + \widehat{\mathbf{B}}^T)\,\mathbf{U}_L = \mathbf{0}.$$

* $\mathbf{U}_R$ are the _right_ eigenvectors, $\mathbf{U}_L$ are the _left_ eigenvectors.
* You **normalize** them so that $\mathbf{U}_L^T \widehat{\mathbf{A}} \mathbf{U}_R = \mathbf{I}$ or some consistent scale.

Define the transformations:

$$\mathbf{z}(t) \;=\; \mathbf{\Psi}_R \;\mathbf{q}_v(t),  
\quad\quad  
\mathbf{\Psi}_R \;=\; \bigl[\,\mathbf{U}_{R,1},\;\mathbf{U}_{R,2},\dots\bigr],$$ $$\mathbf{q}_v(t)\;\in\;\mathbb{C}^{2n} \quad\Longrightarrow \quad  
\text{the “modal coordinates.”}$$

Then

$$\dot{\mathbf{q}}_v(t) - \mathbf{\Lambda}\,\mathbf{q}_v(t)  
\;=\;  
\mathbf{\Psi}_L^T\,\widetilde{\mathbf{\kappa}}(t)\,\mathbf{\Psi}_R\;\bigl[\mathbf{q}_v(t-\tau)\;-\;\mathbf{q}_v(t)\bigr],$$

where:

* $\mathbf{\Lambda}$ is a **block-diagonal** matrix containing the eigenvalues $\lambda_k$.
* $\mathbf{\Psi}_L \equiv (\mathbf{\Psi}_R)^{-1}$ if properly normalized, but carefully set for non-symmetric cases.

Thus the system is now:

$$\dot{\mathbf{q}}_v(t)  
\;=\;  
\underbrace{\Bigl[\mathbf{\Lambda}\;-\;\mathbf{\Psi}_L^T\,\widetilde{\mathbf{\kappa}}(t)\,\mathbf{\Psi}_R\Bigr]}_{\mathbf{A}(t)}  
\;\mathbf{q}_v(t)  
\quad+\quad  
\underbrace{\Bigl[\mathbf{\Psi}_L^T\,\widetilde{\mathbf{\kappa}}(t)\Bigr]}_{\mathbf{B}(t)}  
\;\underbrace{\mathbf{u}(t-\tau)}_{\mathbf{D}\,\mathbf{q}_v(t-\tau)},$$ $$\mathbf{u}(t) \;=\; \mathbf{D}\,\mathbf{q}_v(t)\;\equiv\;\mathbf{\Psi}_R\,\mathbf{q}_v(t).$$

That’s exactly the form:

$$\dot{\mathbf{q}}_v(t) \;=\; \mathbf{A}(t)\,\mathbf{q}_v(t)\;+\;\mathbf{B}(t)\,\mathbf{u}(t-\tau),  
\quad  
\mathbf{u}(t) \;=\; \mathbf{D}\,\mathbf{q}_v(t).$$

**Why it’s Time-Periodic**: The matrix $\widetilde{\mathbf{\kappa}}(t)$ depends on the rotating cutter’s angular position. Over one tooth pass, the entry/exit angles change the cutting force direction, so $\mathbf{A}(t)$ and $\mathbf{B}(t)$ get that same periodic time dependence with period $\tau$.

**Why it’s Non-Symmetric**: If the original machine matrices $\widehat{\mathbf{A}}$ or $\widehat{\mathbf{B}}$ are non-symmetric, or if the operational conditions (gyroscopic effect) break symmetry, the left- and right-eigenvectors differ. That’s how the final $\mathbf{A}(t), \mathbf{B}(t)$ incorporate **non-symmetric cross terms**.

* * *

### 4. You’re Ready for the Semi-Discretization (or Any DDE Technique)

Now you have:

1. A **time-periodic** system matrix $\mathbf{A}(t)$ of dimension $2n$.
2. A **delay** $\tau$.
3. The “delayed input” $\mathbf{u}(t-\tau) = \mathbf{D}\,\mathbf{q}_v(t-\tau)$.

You can use the **semi-discretization method**, **multi-frequency method**, or other numerical approach for delay-differential equations with periodic coefficients. The important part is that you have expressed the system in a consistent state-space form that captures the **non-proportional damping** and **non-symmetric coupling**.

* * *

Summary
-------

1. **Linearize** the cutting-force equation around steady cutting.
2. **Convert** to first-order form (state vector $\mathbf{z}(t)$).
3. **Use** your **modal parameters** (including left & right eigenvectors) to transform $\mathbf{z}(t)$ into $\mathbf{q}_v(t)$.
4. **Obtain** a time-periodic, delay-differential state-space system: $$ \dot{\mathbf{q}}_v(t)  
    =  
    \mathbf{A}(t)\,\mathbf{q}_v(t)  
    +  
    \mathbf{B}(t)\,\mathbf{u}(t-\tau),  
    \quad  
    \mathbf{u}(t)  
    =  
    \mathbf{D}\,\mathbf{q}_v(t).$$
5. **Solve** (or analyze stability) with your preferred DDE approach.

That’s how you implement the **non-proportional, non-symmetric model** in a time-periodic, state-space framework.